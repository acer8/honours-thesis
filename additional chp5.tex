
\begin{dgroup}
\begin{dmath*}
| \rho - s | = | \dfrac{2(z - 1)}{\Delta t(z + 1)} - s |
\end{dmath*}
\intertext{Recall $z = e^{s \Delta t} = \sum_{n = 0}^\infty \dfrac{(s \Delta t)^n}{n !}$ by the definition of exponential function. Hence}
\begin{dmath*}
z = \sum_{n = 0}^\infty \dfrac{(s \Delta t)^n}{n !} = 1 + s \Delta t + \dfrac{(s \Delta t)^2}{2} + \dfrac{(s \Delta t)^3}{6} + \cdots
= 1 + s \Delta t + \dfrac{(s \Delta t)^2}{2} + o((s \Delta t)^3)
\end{dmath*}
\intertext{where we have introduced $o((s \Delta t)^3) = \sum_{n = 3}^\infty \dfrac{(s \Delta t)^n}{n !}$ to simplify the notations. Note we take $\Delta t << 1$ and hence $(s \Delta t)^3$ is the biggest term in $o$. Also we define $o((s \Delta t)^2) = \dfrac{1}{s \Delta t} o((s \Delta t)^3)$ since $s \neq 0, \Delta t > 0$. Further}
\begin{dmath*}
z = \dfrac{(1 + s \Delta t + \dfrac{(s \Delta t)^2}{2} + o((s \Delta t)^3)) (2 - s \Delta t (1 + o((s \Delta t)^2)))}{2 - s \Delta t (1 + o((s \Delta t)^2))}
= \dfrac{2 + 2 s \Delta t + s^2 \Delta t^2 + 2 o(s^3 \Delta t^3) - s \Delta t - s \Delta t \, o(s^2 \Delta t^2) - s^2 \Delta t^2 - s^2 \Delta t^2 \, o(s^2 \Delta t^2) - \dfrac{s^3 \Delta t^3}{2}}{2 - s \Delta t (1 + o((s \Delta t)^2))}
\end{dmath*}
\begin{dmath*}
\dfrac{- \dfrac{s^3 \Delta t^3}{2} \, o(s^2 \Delta t^2)}{}
\end{dmath*}
\intertext{since $\Delta t << 1$ so we can neglect the terms with coefficients $\Delta t^4$ or higher. Then}
\begin{dmath}
z = \dfrac{2 + s \Delta t + o(s^3 \Delta t^3) - \dfrac{s^3 \Delta t^3}{2}}{2 - s \Delta t (1 + o((s \Delta t)^2))}
= \dfrac{2 + s \Delta t - \dfrac{s^3 \Delta t^3}{3} + o (s^4 \Delta t^4)}{2 - s \Delta t (1 + o((s \Delta t)^2))}
= \dfrac{2 + s \Delta t - \dfrac{s^3 \Delta t^3}{3}}{2 - s \Delta t (1 + o((s \Delta t)^2))}
\end{dmath}
\intertext{Then $\Rightarrow$}
\begin{dmath*}
z - 1 = \dfrac{2 + s \Delta t - \dfrac{s^3 \Delta t^3}{3}}{2 - s \Delta t (1 + o((s \Delta t)^2))} - 1 
= \dfrac{2 + s \Delta t - \dfrac{s^3 \Delta t^3}{3} - 2 + s \Delta t (1 + o((s \Delta t)^2))}{2 - s \Delta t (1 + o((s \Delta t)^2))}
= \dfrac{2 s \Delta t - \dfrac{s^3 \Delta t^3}{3} + o(s^3 \Delta t^3)}{2 - s \Delta t (1 + o((s \Delta t)^2))}
= \dfrac{2 s \Delta t - \dfrac{s^3 \Delta t^3}{6} + o(s^4 \Delta t^4)}{2 - s \Delta t (1 + o((s \Delta t)^2))}
\end{dmath*}
\begin{dmath*}
z + 1 = \dfrac{2 + s \Delta t - \dfrac{s^3 \Delta t^3}{3}}{2 - s \Delta t (1 + o((s \Delta t)^2))} + 1
= \dfrac{4 - \dfrac{s^3 \Delta t^3}{3} - o (s^3 \Delta t^3)}{2 - s \Delta t (1 + o((s \Delta t)^2))}
\end{dmath*}
\end{dgroup}
Combine these we obtain
\begin{equation*}
| \rho - s | = | \dfrac{2 (z - 1)}{\Delta t (z + 1)} - s |
= | \dfrac{2}{\Delta t} \dfrac{2 s \Delta t - \dfrac{s^3 \Delta t^3}{6} + o(s^4 \Delta t^4)}{4 - \dfrac{s^3 \Delta t^3}{3} - o (s^3 \Delta t^3)} - s |
= | \dfrac{2 (2 s - \dfrac{s^3 \Delta t^2}{6} + o(s^4 \Delta t^3))}{4 - \dfrac{s^3 \Delta t^3}{3} - o (s^3 \Delta t^3)} - s |
\end{equation*}
By neglecting the terms with coefficients $\Delta t^3$ or higher we then obtain:
\begin{dmath}
| \rho - s | = | \dfrac{4 s - \dfrac{s^3 \Delta t^2}{3}}{4} - s | \leq \dfrac{\Delta t^2}{12} | s |^3
\end{dmath}

%________

for $\bar{\mu}$
\begin{equation}
|\bar{\mu} - \mu| = | \dfrac{\bar{\mu}^2 - \mu^2}{\bar{\mu} + \mu} | = \dfrac{1}{| \bar{\mu} + \mu |} | \bar{\mu}^2 - \mu^2 |
\end{equation}
From the results proved above for $| \rho - s|$ we have
\begin{equation*}
|\bar{\mu}^2 - \mu^2 | = Re |\rho - s| \leq Re \dfrac{\Delta t^2}{12} | s |^3
\end{equation*}
Further because by construction both $\bar{\mu}$ and $\mu$ are positive real numbers and hence
\begin{equation*}
\dfrac{1}{| \bar{\mu} + \mu |} < \dfrac{1}{\mu}
\end{equation*}
Therefore
\begin{equation}
|\bar{\mu} - \mu| < \dfrac{1}{\mu} \dfrac{\Delta t^2}{12} | s |^3
\end{equation}
Thus $\bar{\mu} = \mu + \mathcal{O} (\Delta t^2)$ and $\bar{\mu}$ is a second order approximation to $\mu$.\\

%___________________________________

the rest
\begin{dmath*}
\hat{B} - 1 = \dfrac{z - 1}{z}
= \dfrac{\sum_{n=1}^{\infty}\dfrac{(s \Delta t)^n}{n!}}{1+\sum_{n=1}^{\infty}\dfrac{(s \Delta t)^n}{n!}}
\end{dmath*}
Since $\Delta t$ dominates over other higher terms hence
\begin{equation}
\hat{B} - 1 = \dfrac{\sum_{n=1}^{\infty}\dfrac{(s \Delta t)^n}{n!}}{1+\sum_{n=1}^{\infty}\dfrac{(s \Delta t)^n}{n!}}
\leq \dfrac{\Delta t \sum_{n=1}^{\infty}\dfrac{s^n}{n!}}{1+\sum_{n=1}^{\infty}\dfrac{(s \Delta t)^n}{n!}}
\end{equation}
Obviously, right hand side of the above inequality approaches 0 as $\Delta t \rightarrow 0$. Hence $\hat{B} - 1$ (consequently E (4.31)) does converge to 0, but how fast it converges is not answered. This is however critical to the overall accuracy of the projection methods.\\

Ideally we want $|\dfrac{C \, F(\hat{B} - 1)}{R(z)}| = 0 + \mathcal{O} (\Delta t^2)$.\\
From E (4.31) this requires that
\begin{equation*}
|\dfrac{C \, F}{R(z)}| = \mathcal{O} (\Delta t^2), \, \, \, | \hat{B} - 1| = \mathcal{O} (\Delta t^2)
\end{equation*}
For the second one, recall E (4. 26)
\begin{dmath*}
| \hat{B} - 1| = |\dfrac{1 - z}{z}| = | \dfrac{2 s \Delta t- \dfrac{s^3 \Delta t^3}{6} + o(s^4 \Delta t^4)}{2 + s \Delta t - \dfrac{s^3 \Delta t^3}{3}} |
\end{dmath*}
Neglecting higher order terms
\begin{dmath}
| \hat{B} - 1| = | \dfrac{2 s \Delta t}{2 + s \Delta t} |
\leq | \dfrac{2 s \Delta t}{2} | = |s| \Delta t
\end{dmath}
Hence $| \hat{B} - 1| = \mathcal{O} (\Delta t)$.\\
\textbf{Here I used $s = a + ib$ where $a>0$, can I do this for laplace transform?}\\

Similarly for $\mathcal{B} = 2 \phi^n - \phi^{n-1}$ which is a second order approximation to $\phi^{n+1}$ would result in $\hat{B} - 1 = \mathcal{O} (\Delta t^2)$, however first order accurate is suffices here.\\

%k^2 + \dfrac{2Re\,F}{\Delta t}
Now for the first term, use the identity $| \gamma (\gamma + |k|) \, R(z) | \geqslant |\gamma^2|$
\begin{dmath*}
|\dfrac{C \, F}{R(z)}| = | \dfrac{2|k| (\bar{\mu} + |k|) \, F}{\gamma(\gamma + |k|) \, R(z)} |
\leq | \dfrac{2|k| (\bar{\mu} + |k|) \, F}{\gamma^2 \, R(z)} |
\end{dmath*}

Further recall $R(z) = \dfrac{2 z(1 + Q(z))}{1 + z}$ where $\hat{q} = Q(z)\hat{\phi}$ but $q = 0 \Rightarrow Q(z) = 0$. Therefore (also from E (4.26) and neglecting higher order terms)
\begin{equation}
R(z) = \dfrac{2 z}{1 + z} = \dfrac{2 (2 + s \Delta t)}{4} = 1 + \dfrac{1}{2} s \Delta t
\end{equation}
However we know that $1 >> \Delta t$ and hence 1 dominates the error. Hence $R(z) = \mathcal{O} (1)$.\\

$\Rightarrow$
\begin{equation}
| \dfrac{2|k| (\bar{\mu} + |k|) \, F}{\gamma^2 \, R(z)} | \leq | \dfrac{2|k| (\bar{\mu} + |k|) \, F}{\gamma^2}|
\end{equation}
\begin{equation*}
= |\dfrac{2|k| (\bar{\mu} + |k|) \, F}{k^2 + \dfrac{2 Re \, F}{\Delta t}}| 
\leq |\dfrac{2|k| (\bar{\mu} + |k|) \, F}{\dfrac{2 Re \, F}{\Delta t}}| 
\end{equation*}
$\Rightarrow$
\begin{dmath*}
|\dfrac{C \, F}{R(z)}| \leq |\dfrac{\Delta t |k| (\bar{\mu} + |k|)}{Re}| \, \, \, (\mathcal{O} (\Delta t))
\end{dmath*}

Hence together we have 
\begin{equation}
|\dfrac{C \, F (\hat{B} - 1)}{R(z)}| = \mathcal{O} (\Delta t^2)
\end{equation}
This leads to 
\begin{equation*}
\dfrac{R(z) |k|}{\rho} A_1 = \dfrac{(\mu + |k|)}{Re \, s} (\mu \hat{\alpha} - ik \hat{\beta}) + \mathcal{O} (\Delta t^2)
\end{equation*}
This relation holds for all projection methods.\\

Now we compute the accuracy for the first component of $\hat{u}$: compare 
$U e^{-\bar{\mu} x}$ numerical and $\dfrac{(\mu + |k|)}{Re \,s} (- |k| \hat{\alpha} + ik \hat{\beta}) e^{-\mu x}$ reference solution.\\

First note since $\bar{\mu} = \mu + \mathcal{O} (\Delta t^2)$ then
\begin{equation*}
| e^{\bar{\mu}x} - e^{\mu x} | = | \sum_{n=0}^{\infty} \dfrac{(\bar{\mu} x)^n - (\mu x)^n}{n!} |
\end{equation*}
\begin{equation*}
= | 0 + (\bar{\mu}x - \mu x) + \dfrac{((\bar{\mu} x)^2 - (\mu x)^2)}{2} + \cdots
\end{equation*}
\begin{equation*}
\leq |\bar{\mu} - \mu| |x| + |\dfrac{((\bar{\mu} x)^2 - (\mu x)^2)}{2}| + \cdots
\end{equation*}
Neglecting higher error terms we obtain
\begin{equation*}
| e^{\bar{\mu}x} - e^{\mu x} | \leq \mathcal{O} (\Delta t^2)
\end{equation*}

As for their coefficients\\
\begin{equation*}
U = \hat{\alpha} - \dfrac{(\bar{\mu} \hat{\alpha} - ik \hat{\beta}) \, (\bar{\mu} + |k|)}{Re \, \rho} (1 + \dfrac{C\,F(\hat{B} - 1)}{R(z)})^{-1}
= \dfrac{(\bar{\mu} + |k|) (-|k| \hat{\alpha} + ik \hat{\beta})}{Re \rho} (1 + \dfrac{C\,F(\hat{B} - 1)}{R(z)})^{-1}
\end{equation*}
Because $(1 + \dfrac{C\,F(\hat{B} - 1)}{R(z)})^{-1} = 1 + \mathcal{O} (\Delta t^2)$ , hence we can treat this term as $1$ and only need to compare the rest of the $U$ with the reference solution coefficient.
\begin{equation*}
| \dfrac{(\bar{\mu} + |k|) (-|k| \hat{\alpha} + ik \hat{\beta})}{Re \rho} - \dfrac{(\mu + |k|) (-|k| \hat{\alpha} + ik \hat{\beta})}{Re s} |
= | (\dfrac{(\bar{\mu} + |k|)}{\rho} - \dfrac{(\mu + |k|)}{s}) \, \dfrac{(-|k| \hat{\alpha} + ik \hat{\beta})}{Re}|
\end{equation*}
\begin{equation*}
\leq | (\dfrac{\mathcal{O} (\Delta t^2)}{(\mu - |k|)^2}| \, |(-|k| \hat{\alpha} + ik \hat{\beta})|
\end{equation*}

Combine these results we finally obtain an error bound for the $u$ velocity\\

$| \hat{u}_{numerical} - \hat{u}_{reference} | $
\begin{equation*}
\leq |U - \dfrac{(\mu + |k|) (-|k| \hat{\alpha} + ik \hat{\beta})}{Re s}| \, |e^{-\bar{\mu} x} - e^{-\mu x} | + | \dfrac{R(z) |k|}{\rho} A_1 - \dfrac{\mu + |k|)}{Re s} (\mu \hat{\alpha} - ik \hat{\beta}) | \, |e^{- |k|x}|
\end{equation*}
\begin{equation*}
= | \dfrac{(\bar{\mu} + |k|) (-|k| \hat{\alpha} + ik \hat{\beta})}{Re \rho} - \dfrac{(\mu + |k|) (-|k| \hat{\alpha} + ik \hat{\beta})}{Re s} |\, |e^{-\bar{\mu} x} - e^{-\mu x} | 
\end{equation*}
\begin{equation*}
+ | \dfrac{R(z) |k|}{\rho} E^{-1} (\mu \hat{\alpha} - ik \hat{\beta}) - \dfrac{\mu + |k|)}{Re s} (\mu \hat{\alpha} - ik \hat{\beta}) | \, |e^{- |k|x}|
\end{equation*}
\begin{equation*}
= | \mathcal{O} (\Delta t^2) |\cdot |\mathcal{O} (\Delta t^2)| + |\mathcal{O} (\Delta t^2)| \cdot| (\mu \hat{\alpha} - ik \hat{\beta}) | \cdot |e^{- |k|x}|
\leq \mathcal{O} (\Delta t^2) 
\end{equation*}

Hence overall $\hat{u}$ is second order accurate in time. Similar results shows $\hat{v}$ is second order accurate too. These results hold for all projection methods ($Pm 1 (a), (b)$ and $Pm 2$).\\

The error analysis for pressure is more complicated since the accuracy depends on the particular projection methods.\\

From E (4.12) and E (4.13) we found that
\begin{equation*}
\hat{p}^{n+1/2} = Q(z)\hat{\phi}^{n+1} + L\hat{\phi}^{n+1}
\end{equation*}
Since $n + 1/2$ is half time step away from $n+1$, hence $\hat{p}^{n+1} = z^{1/2} \, \hat{p}^{n+1/2}$. Dropping the $n+1/2$ index we obtain an equation relating the pressure and the scalar potential ($\phi$) resulted from the projection\\
\begin{equation}
\hat{p} = z^{1/2} \, (Q(z) + L)\hat{\phi}
\end{equation}
This equation is the Fourier transformed Pressure update formula and hence governs the accuracy of pressure. The choice of $Q(z)$ and $L$ varies between projection methods and they must be chosen carefully to ensure second order accuracy.\\

Let's consider the 3 projection methods separately.\\
1. $Pm\,1 \, (a)$\\
This corresponds to $q = p^{n-1/2}$, $L = I$ and $\mathcal{B} = 0 \, (\hat{B} = 1)$. The boundary condition for $\textbf{u}^{n+1}$ is satisfied exactly. Substituting this into the previous equations leads to
\begin{equation*}
\hat{q} = Q(z)\,\hat{\phi} = \hat{p}^{n-1/2} = \dfrac{1}{z^{3/2}}\,\hat{p} = \dfrac{1}{z^{3/2}} \, z^{1/2} (Q(z) + 1) \hat{\phi}
\end{equation*}
\begin{equation*}
\Rightarrow Q(z) = \dfrac{1}{z} (Q(z) + 1)
\end{equation*}
Hence we obtain a simple expression for $Q(z)$
\begin{equation}
Q(z) = \dfrac{1}{z-1}
\end{equation}
and therefore
\begin{equation}
\hat{p} = \dfrac{z^{3/2}}{z-1} \, \hat{\phi} = \dfrac{z^{3/2}}{z-1}\, A_1 e^{-|k|x} + \dfrac{z^{3/2}}{z-1} \, A_2 e^{-\gamma x}
\end{equation}
It is obvious that this formula would result in a degraded accuracy because it contains the spurious mode $A_2 e^{-\gamma x}$. The spurious mode is:
\begin{equation*}
- \, \dfrac{(\bar{\mu} \hat{\alpha} - ik \hat{\beta})\,(\bar{\mu} + |k|)}{\gamma Re \rho R(z)}
\end{equation*}

Because this term will not converge to zero and hence the pressure in $Pm \, 1\,(a)$ will remain less than second order accurate. In fact, as proved in \emph{Brown et. al 2001} paper \cite{brown2001accurate}, $\dfrac{z^{3/2}}{z-1}\,A_2 \,e^{-\gamma x} \sim \mathcal{O} (\Delta t)$ and hence pressure will actually be first order accurate.\\
\textbf{I am not totally sure how Brown proved $\dfrac{z^{3/2}}{z-1}\,A_2 \,e^{-\gamma x} \sim \mathcal{O} (\Delta t)$. Maybe this is to do with $\gamma$? ($\gamma^2 = k^2 + \dfrac{2Re}{\Delta t}F$). But the degradation in accuracy is clear. }\\

2. $Pm \, 1\,(b)$. The pressure approximation and boundary condition for $\textbf{u}^*$ are the same with $Pm\,1\,(a)$ however in this case we are using the more accurate pressure update formula: 
\begin{equation*}
L = I - \dfrac{\Delta t}{2\,Re}\,\nabla^2
\end{equation*}
This leads to the following Fourier transformed pressure update formula
\begin{equation*}
\hat{p} = z^{1/2}\,(Q(z)+1-\dfrac{\Delta t}{2\,Re}\,(\partial_x^2-k^2))\,\hat{\phi}
\end{equation*}
Expand $\phi$
\begin{dmath*}
\hat{p} = z^{1/2}\,(Q(z)+1-\dfrac{\Delta t}{2\,Re}\,(\partial_x^2-k^2))\,(\hat{\phi}_1 + \hat{\phi}_2)
= z^{1/2}\,(Q(z)\,\hat{\phi}_1 + \hat{\phi}_1  - \dfrac{\Delta t}{2\,Re}\,(\partial_x^2-k^2)\,\hat{\phi}_1 + \dfrac{\Delta t}{2\,Re}\,(- \partial_x^2+k^2 + \dfrac{2\,Re}{\Delta t} + \dfrac{2\,Re}{\Delta t}\, Q(z))\,\hat{\phi}_2)
= z^{1/2}\,(Q(z)\,\hat{\phi}_1 + \hat{\phi}_1  - \dfrac{\Delta t}{2\,Re}\,(\partial_x^2-k^2)\,\hat{\phi}_1 + \dfrac{\Delta t}{2\,Re}\,(- \partial_x^2+\lambda^2 + \dfrac{2\,Re}{\Delta t} \, Q(z))\,\hat{\phi}_2)
\end{dmath*}
From E (4.14) we can eliminate $(\partial_x^2-k^2)\,\hat{\phi}_1$ and $\dfrac{\Delta t}{2\,Re}\,(- \partial_x^2+\lambda^2 + \dfrac{2\,Re}{\Delta t} \, Q(z))\,\hat{\phi}_2)$.\\

Hence we obtain:
\begin{equation}
\hat{p} = z^{1/2}\,(Q(z) + 1)\,\hat{\phi}_1
\end{equation}

Hence it is clear that this new update formula successfully eliminated the spurious mode ($\hat{\phi}_2$). This should lead to a significant improve in accuracy. \\

Now let's formally analyse the error to prove our above hypothesis. As before, $Q(z) = \dfrac{1}{z-1}$ . Therefore
\begin{equation}
\hat{p} = \dfrac{z^{3/2}}{z-1}\,A_1\,e^{-|k|x} = \dfrac{z^{3/2}}{(z-1)} \dfrac{1}{R(z)} \dfrac{(\bar{\mu} + |k|)\,(\bar{\mu} \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|}\,e^{-|k|x}
\end{equation}

and $R(z) = \dfrac{2z(1+Q(z))}{1+z} = \dfrac{2z(1+\dfrac{1}{z-1})}{1+z} = \dfrac{2z^2}{z^2 - 1}$.\\


\begin{equation}
\hat{p} = \dfrac{z+1}{2z^{1/2}}\,\dfrac{(\bar{\mu} + |k|)\,(\bar{\mu} \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|}\,e^{-|k|x}
\end{equation}

Since $\bar{\mu} = \mu + \mathcal{O} (\Delta t^2)$, hence it that the second part of $\hat{p}$ is at least second order approximation to the reference $\hat{p}$. It is the coefficient ($\dfrac{z+1}{2z^{1/2}}$) which could potentially degrade the accuracy. In principal we want this coefficient converges to 1 as $\Delta t \rightarrow 0$.\\

\begin{equation*}
|\,\dfrac{z+1}{2 z^{1/2}} - 1\,| = |\,\dfrac{z+1-2 z^{1/2}}{2 z^{1/2}}\,| = |\,\dfrac{e^{s\Delta t} + 1 -2 e^{s \Delta t/2}}{2 e^{s \Delta t/2}}\,|
\end{equation*}
\begin{equation*}
 = |\,\dfrac{\sum_{n=0}^{n=\infty} \dfrac{(s\Delta t)^n}{n!} + 1 - 2 \sum_{n=0}^{n=\infty} \dfrac{(s\Delta t/2)^n}{n!}}{2 \sum_{n=0}^{n=\infty} \dfrac{(s\Delta t/2)^n}{n!}}\,|
\end{equation*}
\begin{equation*}
= |\,\dfrac{2 + s\Delta t + \dfrac{(s\Delta t)^2}{2} -2 - s\Delta t - \dfrac{(s\Delta t)^2}{4}+ o((s\Delta t/2)^3)}{2+s\Delta t + \dfrac{(s\Delta t)^2}{4} + o((s\Delta t/2)^3)}\,|
\end{equation*}
Therefore based on the above equation, it is clear that $|\,\dfrac{z+1}{2 z^{1/2}} - 1\,|$ does converge to zero as $\Delta t \rightarrow 0$. Now let's examine the rate of convergence for this term.\\

By neglecting the remaining higher order terms we obtain
\begin{equation}
|\,\dfrac{z+1}{2 z^{1/2}} - 1\,| = |\,\dfrac{\dfrac{(s\Delta t)^2}{4}}{2+s\Delta t + \dfrac{(s\Delta t)^2}{4}}\,| \\
\leq |\,\dfrac{\dfrac{(s\Delta t)^2}{4}}{2}\,| = |\,\dfrac{(s\Delta t)^2}{8}\,| = \mathcal{O} (\Delta t^2)
\end{equation}
\textbf{I think this inequality holds if $s>0$ is a positive real number, but $s$ is actually a complex number and hence I am not sure how to eliminate the $\Delta t$ terms in the denominator and obtain a $o(\Delta t^2)$ bound. However the result is true according to Brown's paper, just not sure how he proved it}\\

Now consider the main part of $\hat{p}$.
\begin{equation*}
|\,\dfrac{(\bar{\mu} + |k|)\,(\bar{\mu} \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|} - \dfrac{(\mu + |k|)\,(\mu \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|}\,|
\end{equation*}
\begin{equation*}
= \dfrac{1}{Re\,|k|}|\,(\bar{\mu} + |k|)\,(\bar{\mu} \hat{\alpha}  -ik \hat{\beta}) - (\mu + |k|)\,(\mu \hat{\alpha}  -ik \hat{\beta})\,|
\end{equation*}
\begin{equation*}
\leq \dfrac{1}{Re\,|k|}|\,\hat{\alpha}((\bar{\mu}^2 - \mu^2) + |k|\,(\bar{\mu} -\mu))\,| + |ik \hat{\beta} ( \bar{\mu} - \mu)\,|
\end{equation*}
Since also $\bar{\mu}^2 - \mu^2 = Re\,(\rho - s) = \mathcal{O} (\Delta t^2)$ hence we have
\begin{equation*}
|\,\dfrac{(\bar{\mu} + |k|)\,(\bar{\mu} \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|} - \dfrac{(\mu + |k|)\,(\mu \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|}\,|
\end{equation*}
\begin{equation*}
\leq \dfrac{1}{Re\,|k|}|\,\hat{\alpha}(\mathcal{O} (\Delta t^2) + |k|\,\mathcal{O} (\Delta t^2))\,| + |ik \hat{\beta} \mathcal{O} (\Delta t^2)\,|
\end{equation*}
\begin{equation}
=  \mathcal{O} (\Delta t^2)
\end{equation}

Thus combining the results we obtained above, we can now bound the error between the numerical and reference pressure.\\
By E (4.43) and E (4.9 (c))
\begin{equation*}
|\,\hat{p}_{numerical} - \hat{p}_{exact}\,| =|\, \dfrac{z+1}{2 z^{1/2}} \dfrac{(\bar{\mu} + |k|)\,(\bar{\mu} \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|} - \dfrac{(\mu + |k|)\,(\mu \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|}\,|
\end{equation*}
\begin{equation*}
= |\, \dfrac{z+1}{2 z^{1/2}} (\dfrac{(\mu + |k|)\,(\mu \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|} + \mathcal{O} (\Delta t^2)) - \dfrac{(\mu + |k|)\,(\mu \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|}\,|
\end{equation*}
\begin{equation*}
\leq  |\, \dfrac{(\mu + |k|)\,(\mu \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|}(\dfrac{z+1}{2 z^{1/2}} - 1)\,| + |\,\mathcal{O} (\Delta t^2)\dfrac{z+1}{2 z^{1/2}}\,|
\end{equation*}
Then this implies
\begin{equation}
|\,\hat{p}_{numerical} - \hat{p}_{exact}\,| =  |\, \dfrac{(\mu + |k|)\,(\mu \hat{\alpha}  -ik \hat{\beta})}{Re\,|k|}\,\mathcal{O} (\Delta t^2)\,| + |\,\mathcal{O} (\Delta t^2)\dfrac{z+1}{2 z^{1/2}}\,| = \mathcal{O} (\Delta t^2)
\end{equation}

Hence here we have proved that by eliminating the spurious mode, the new pressure update formula used in $Pm\,1(b)$ indeed proves second order accuracy in pressure.\\

Does the same result hold for $Pm\,2$ where the same formula for pressure is used? Well the answer is yes but we need to pay attention to the boundary conditions of the projection ($\mathbb{B}$ and $C$).\\

Since pressure is not involved in the update of solutions ($q = 0$) leads to $Q(z) = 0$. Hence by E (4.38), we have pressure given as
\begin{equation}
\hat{p} = z^{1/2}\,L\hat{\phi}
\end{equation}
where $L = 1 - \dfrac{\Delta t}{2Re}\,(\partial_x^2 - k^2)$ is the improved formula. \\
Hence
\begin{equation}
\hat{p} = z^{1/2}\,\hat{\phi}_1 = z^{1/2}\,A_1\,e^{-|k|x}
\end{equation}
which again eliminates the spurious mode.\\

We want the coefficient $A_1$ be at least second order accurate compared to the coefficient for the reference pressure solution. As shown by our previous analysis, all the boundary conditions suffices here. However better approximation to $\phi^{n+1}$ leads to a decrease in size of error. More importantly as noted by many researchers including Brown and Strikwerda enforcing $\textbf{$\tau$}\cdot\phi^{n+1}$ to be zero causes non-smoothness for $\textbf{u}^*$ along the boundary because $\textbf{u}^*$ is not a second order approximation to $\textbf{u}^{n+1}$ now \cite{strikwerda1999accuracy}. This is supported by our numerical results in Chapter 6 section: ``Necessity for accurate approximation to $\phi^{n+1}$".\\

Hence we have demonstrated that the error bounds can be second order for all the projection methods considered provided the better pressure approximation formula is used.\\

\begin{itemize}
\item 2. Square domain
\end{itemize}
We have shown that the projection methods could be made fully second order accurate in a periodic semi-infinite strip, however does the same result hold in other domains and boundary conditions? Here let us repeat the analysis in a more general rectangular domain $[-1,1] \times [0,\alpha]$ with homogeneous Dirichlet boundary conditions imposed. This also gives raise more normal modes too.\\

The domain considered is similar to that of \emph{Shen et al.} paper \cite{pyo2005normal}. However in our analysis, we don't restrict the y boundaries to be periodic because we are more concerned with the interaction between the other two boundaries (at $x=-1$ and $x=1$).\\
We are still concerned with the linearised Stokes equations and again we have taken Reynolds number to be one for simplicity. The problem is summarised below:
\begin{dgroup}
\begin{dmath}
\partial_x \textbf{u} + \nabla p = \nabla^2\textbf{u}
\end{dmath}
\begin{dmath}
\nabla \cdot \textbf{u} = 0
\end{dmath}
\intertext{with the Dirichlet boundary condition specified along the west wall (at $x = -1$) and the east wall ($x = 1$).}
\begin{dmath}
\textbf{u} (\pm 1, y, t) = 0
\end{dmath}
\end{dgroup}
Again, taking the divergence of momentum equation leads to $\nabla^2 p = 0$. In transformed version: $(\partial_x^2 - k^2) \hat{p} = 0$. This then leads to the solution: $\hat{p} = P_1\,e^{-|k|x} + P_2\,e^{|k|x}$

\subsection{Normal mode analysis of Gauge method}
In this subsection, the accuracy of the Gauge method is explored. We will demonstrate that the introduction consistent update of Gauge variable lead to significant improvement over the accuracy in pressure simulations.\\

For simplicity let's take the periodic channel analysed for Projection methods before. The geometry is the same and hence we take the same boundary conditions for analytical velocities ($\textbf{u}$).\\
Recall the semi-discretised Gauge formulation for the linearised Stokes equations:
\begin{dgroup}
\begin{equation}
\dfrac{m^{n+1} -m^n}{\Delta t} = \dfrac{1}{2} \nabla^2\left(m^{n+1} + m^n\right)
\end{equation}
\intertext{\\
By the periodic geometry,the boundaries at $y = 0,\,2\pi$ are periodic. Only the Dirichlet boundary at $x=0$ needs to be specified. At this boundary, the x direction is normal and the y direction is tangential. Hence we have\\
}
\begin{dmath}
u(0,y,t) = \alpha(y,t) \condition{   and $v(0,y,t) = \beta(y,t)$}
\end{dmath}
\begin{dmath}
m_1(0,y,t) = \alpha(y,t) \condition{   and $m_2(0,y,t) = v(0,y,t) + \partial_y \chi (0,y,t)$}
\end{dmath}
\intertext{\\
Performing projection\\
}
\begin{dmath}
\nabla^2 \chi^{n+1} = \nabla \cdot \textbf{m}^{n+1} \condition{   with $\partial_x \chi^{n+1} = 0$}
\end{dmath}
\begin{dmath}
\textbf{u}^{n+1} = \textbf{m}^{n+1} - \nabla \chi^{n+1}
\end{dmath}
\intertext{\\
By making the normal boundary condition the same for the Gauge variable and velocity $\textbf{u}^*$, we obtain a zero Neumann boundary condition for the auxiliary field $\chi^{n+1}$. Similar to the projection method, this is one of the most common boundary condition for auxiliary fields.}
\end{dgroup}

Again the Reynolds number is made to be 1 for simplicity.\\
Because the Gauge variable $\textbf{m}$ is being updated consistently, hence like velocities and pressure we have a nice relationship between the Gauge variables calculated at different time iterations: $\textbf{m}^{n+1} = z \textbf{m}^n$ (where $z$ again is the discrete Laplace transform variable). This was not possible for the intermediate velocity field shown in the projection methods because it is rather discarded after each iteration. We cannot really locate the variable in time and thus makes the tracking of its errors difficult.\\

In this case, we can solve the Gauge variables directly by performing Laplace and Fourier transforms.\\
\begin{equation*}
\dfrac{\hat{\textbf{m}} - \dfrac{\hat{\textbf{m}}}{z}}{\Delta t} = \dfrac{1}{2}\left(\partial_x^2 - k^2 \right)
\left(\hat{\textbf{m}} + \dfrac{\hat{\textbf{m}}}{z} \right)
\end{equation*}
After rearranging and define $\bar{\mu} = k^2 + \rho$ where $\rho = \dfrac{2(z-1)}{\Delta t \,(z+1)}$, the transformed momentum equations (in components) are:

\begin{dgroup}
\begin{dmath}
\left( \partial^2_x - \bar{\mu}^2 \right) \, \hat{m}_1 = 0
\end{dmath}
\begin{dmath}
\left( \partial^2_x - \bar{\mu}^2 \right) \, \hat{m}_2 = 0
\end{dmath}
\end{dgroup}
Solving these 2 ordinary differential equations we obtain an expression for $\hat{textbf{m}}$:
\begin{dgroup}
\begin{dmath}
\hat{m}_1 = A_1\,e^{-\bar{\mu} x}
\end{dmath}
\begin{dmath}
\hat{m}_2 = A_2\,e^{-\bar{\mu} x}
\end{dmath}
\end{dgroup}
where $A_1$ and $A_2$ are constants to be determined.\\
Note that unlike the intermediate velocities in Projection methods, the Gauge variable actually does not contain any spurious mode! This would indeed lead to an improved accuracy since there is no numerical boundary in $\textbf{m}$.\\
This in turn guarantees the auxiliary field is also free of spurious modes. It is solved by the compatibility condition (\textbf{equation ()}):
\begin{equation}
\left(\partial_x^2 - k^2 \right)\,\hat{\chi} = \partial_x \hat{m}_1 + ik\hat{m}_2
\end{equation}
which then leads to an expression of $\hat{\chi}$ as:
\begin{dmath}
%\hat{\chi} = \dfrac{1}{\rho} \left(P\,e^{-|k|\,x} - \bar{\mu} \hat{m}_1 + ik\hat{m}_2 \right)
%= \dfrac{1}{\rho} \left(P\,e^{-|k|\,x} - A\,\bar{\mu} e^{-\bar{\mu} x} + ik\,B\,e^{-\bar{\mu} x} \right)
\hat{\chi} = P e^{-|k|x} + \dfrac{(-\bar{\mu}A_1 + ikA_2)}{\rho}e^{-\bar{\mu}x}
\end{dmath}

The velocities and pressure can then be recovered using the compatibility condition and the Gauge update formula respectively.\\

\begin{dgroup}
\begin{dmath}
\hat{u} = \hat{m}_1 - \partial_x \hat{\chi} = |k|Pe^{-|k|x} + \dfrac{\left(-k^2A_1 + ikA_2\bar{\mu} \right)}{\rho}e^{-\bar{\mu}x}
\end{dmath}
\begin{dmath}
\hat{v} = \hat{m}_2 - ik \hat{\chi} = -ikPe^{-|k|x} + \dfrac{\left(A_2\bar{\mu}^2 + ikA_1\bar{\mu} \right)}{\rho}e^{-\bar{\mu}x}
\end{dmath}
\end{dgroup}
The pressure can be recovered using the transformed Pressure update formula:
\begin{equation*}
\dfrac{\hat{p}}{\sqrt{z}} = \dfrac{1}{\Delta t}\left(1 - \dfrac{1}{z} \right)\,\hat{\chi} - \dfrac{1}{2} \left(\partial_x^2 - k^2\right)\left(1 + \dfrac{1}{z}\right)\,\hat{\chi}
\end{equation*}
Leading to 
\begin{equation}
\hat{p} = \dfrac{z+1}{2\,z^{1/2}}\left(\rho\,Pe^{-|k|x}\right)
\end{equation}
Unlike in projection method, the spurious mode must be eliminated with special pressure update formulas, the velocities and pressure in Gauge method naturally leads to the exclusion of spurious modes. Hence this demonstrates that no numerical boundary layers are formed in Gauge method. This is also confirmed by our numerical studies presented in Chapter 6.\\

Equipped with the boundary conditions given, we can then solve for the undetermined coefficients in the solutions above. \\

Normal component:
\begin{equation}
\hat{m}_1 \,|_{x=0} = \hat{u}\, |_{x=0} = \hat{\alpha}
\end{equation}

The tangential boundary condition for $\hat{textbf{m}}$ needs more attention, because by compatibility condition, solving $\textbf{m}^{n+1}$ requires the knowledge of $\chi^{n+1}$ which we don't have access yet:
\begin{equation}
\hat{u}\,|_{x=0} = \hat{m}_2\,|_{x=0} - ik \hat{\chi}^{n+1}\,|_{x=0} = \hat{\beta}\,\,\,\text{   exact relation}
\end{equation}
An approximation to $\hat{\chi}^{n+1}$ is needed and similar to the projection methods, we use the same function: $\hat{B}$ to represent the different approximations.\\
%\begin{equation*}
%\hat{B} = 1,\,\dfrac{1}{z},\,\dfrac{2z-1}{z^2}\,\,\, \text{   for 
%\end{equation*}
\begin{equation}
\hat{m}_2\,|_{x=0} = \hat{u}\,|_{x=0} + ik \hat{B}\hat{\chi}^{n+1}\,|_{x=0} \,\,\,\text{   actual boundary condition used in practice}
\end{equation}
Combine \textbf{equation () and ()} we get:
\begin{equation}
\hat{u}\,|_{x=0} + ik \hat{\chi}\,(\hat{B}-1)\,|_{x=0} = \hat{\beta}
\end{equation}

Same problem in regarding to the choice of auxiliary field approximation function $\hat{B}$. We can choose no approximation to $\chi^{n+1}$ which corresponds to $\hat{B} = 1$. This is artificially enforcing the Gauge variable and the velocities to be equal at all boundaries. This as noted by many researchers including \emph{strikwerda, Brown} that this would introduce non-smooth along boundary as the Gauge variable (or the intermediate velocity in $Pm\,2$) is not be a close approximation to the velocities \cite{strikwerda1999accuracy, brown2001accurate}. This choice of tangential boundary condition for $\textbf{m}$ lead to degraded accuracy in velocities and pressure. There is a nice proof by Strikwerda in \cite{strikwerda1999accuracy} about the neccessity for tangential boundary conditions. Later we will demonstrate this through numerical tests.\\

Now because the tangential boundary condition for $v$ is not exactly satisfied in the projection step (see \textbf{equation ()}), we need to ensure it approaches $\beta$ along the boundary at a second order rate. Hence second order approximation to $\phi^{n+1}$ is needed and this corresponds to $\hat{B} = \dfrac{2z-1}{z^2}$ (For $Pm\,2$ first order approximation to $\phi^{n+1}$ is sufficient since the approximation term is a multiplied with $\Delta t$ by the compatibility equation).\\

Hence along the boundary (taking $x=0$) we note the Gauge variables must satisfy:
\begin{dgroup}
\begin{dmath}
A_1 = \hat{\alpha} \condition{   $m_1$ at $x=0$}
\end{dmath}
\begin{dmath}
A_2 - ik\left(\dfrac{2z-1}{z^2}\right)\left(P + \dfrac{(-\bar{\mu}A_1 + ikA_2)}{\rho} \right) = \hat{\beta}
\end{dmath}
\end{dgroup}

Further because the auxiliary field satisfies a zero Neumann normal boundary condition ($\partial_x\hat{\chi} = 0$) hence we have:
\begin{equation}
\bar{\mu}^2A_1 - ik\bar{\mu}A_2 - |k|\rho\,P = 0
\end{equation}

Summaries these conditions we can solve for $A_1,\,A_2$ and $P$ directly:
\begin{equation}
\begin{bmatrix}
\bar{\mu}^2 & -ik\bar{\mu} & -|k|\rho \\
ik\bar{\mu}\hat{B}(z) & \left(\rho + k^2\hat{B}(z)\right) & -ik\hat{B}(z)\rho\\
1 & 0 & 0 \\
\end{bmatrix}
\begin{bmatrix}
A_1\\
A_2\\
P\\
\end{bmatrix}
= \begin{bmatrix}
0\\
\hat{\beta}\rho\\
\hat{\alpha}\\
\end{bmatrix}
\end{equation}
where $\hat{B}(z) = \dfrac{2z-1}{z^2}$. Further it can be shown by a Taylor expansion argument that $\dfrac{1}{\hat{B}(z)} = \dfrac{z^2}{2z-1} = 1 + \mathcal{O}(\Delta t^2)$. Substitute this back into the linear system above (Equation 5.78) and then we can solve for $A_1,\,A_2$ and $P$ easily.

\begin{dgroup}
\begin{dmath}
A_1 = \hat{\alpha}
\end{dmath}
\begin{dmath}
A_2 = \dfrac{\bar{\mu}^2\hat{\alpha} - (\bar{\mu} + |k|)(\bar{\mu}\hat{\alpha} - ik\hat{\beta})}{ik\bar{\mu}} + \mathcal{O}(\Delta t^2)
\end{dmath}
\begin{dmath}
P = \dfrac{(\bar{\mu} + |k|)(\bar{\mu}\hat{\alpha} - ik\hat{\beta})}{\rho \,|k|} + \mathcal{O}(\Delta t^2)
\end{dmath}
\end{dgroup}

The numerical solutions can then be recovered using Equation 5.70 and 5.71 by directly substituting $A_1,\,A_2$ and $P$ into the expressions for $\hat{u}, \,\hat{v}$ and $\hat{p}$.
\begin{equation}
\begin{cases}
\hat{u}_{nu} = \left(\dfrac{(\bar{\mu}+|k|)(-|k|\hat{\alpha}+ik\hat{\beta})}{\rho} + \mathcal{O}(\Delta t^2) \right)e^{-\bar{\mu}x} + \left(\dfrac{(\bar{\mu} + |k|)(\bar{\mu}\hat{\alpha} - ik\hat{\beta})}{\rho} + \mathcal{O}(\Delta t^2) \right)e^{-\bar{\mu}x}\\
\hat{v}_{nu} =  \left(\dfrac{i\bar{\mu}(\bar{\mu} + |k|)\,\left(- \dfrac{k}{|k|}\hat{\alpha}+i\hat{\beta}\right)}{\rho} +\mathcal{O}(\Delta t^2)\right) e^{-\bar{\mu} x} +  \left(\dfrac{-ik(\bar{\mu} + |k|)(\bar{\mu}\hat{\alpha} - ik\hat{\beta})}{\rho|k|} +\mathcal{O}(\Delta t^2)\right) e^{- |k| x} \\
\hat{p}_{nu} = \dfrac{z+1}{2z^{1/2}}\,\left(\dfrac{(\bar{\mu} + |k|)(\bar{\mu}\hat{\alpha} - ik\hat{\beta})}{|k|} + \mathcal{O}(\Delta t^2) \right)e^{-\bar{\mu}x}\\
\end{cases}
\end{equation}
where $nu$ denotes ``numerical" to distinguish from the analytical solutions in Equation 5.9.\\

Now recall from the subsection Projection methods, we have shown that $\rho = s + \mathcal{O} (\Delta t^2), \, \bar{\mu} = \mu + \mathcal{O} (\Delta t^2)$ and $\dfrac{z+1}{2z^{1/2}} = 1 + \mathcal{O} (\Delta t^2)$. Hence it is straightforward to show that the coefficients in the numerical solutions above are of second order accuracy to that of the analytical solutions presented in Equation 5.9.\\

Hence with the Gauge variable tangential boundary equals to $\textbf{$\tau$}\cdot\left(\textbf{u}^{n+1} + (2\chi^n - \chi^{n-1})\right)$, the Gauge method shows completely second order accuracy in both velocities and pressure. Also because neither the Gauge variable and the auxiliary field contains spurious modes, hence there is no special formula needed to filter out the numerical boundary layers as in Projection methods. This means the error convergence does not depend on the domain and boundary conditions as much as the projection methods which has fully second order accuracy only in periodic domains. The Gauge method exhibits the same order of accuracy in general domains too (see Shen' paper \cite{pyo2005normal,guermond2006overview} for details of proof).